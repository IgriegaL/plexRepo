# Configuración de Netdata para Orange Pi 5
# Optimizado para persistir datos tras reinicios

[db]
    # Usar dbengine para persistir datos en disco
    mode = dbengine
    
    # Guardar 48 horas de datos (en segundos)
    # Puedes aumentar a 604800 (7 días) si quieres más histórico
    retention = 172800
    
    # Espacio en disco para la base de datos (MB)
    # 512MB para 48 horas de datos
    dbengine disk space MB = 512
    
    # Actualizar la DB cada 3 segundos (default es 1)
    # Esto reduce uso de CPU y disco
    update every = 3

[global]
    # Intervalo de recolección de métricas
    update every = 3
    
    # Reducir uso de memoria
    memory mode = dbengine
    
    # Mantener páginas en cache (MB)
    page cache size = 32
    
    # Historia en memoria antes de escribir a disco (segundos)
    dbengine page cache with malloc = yes
    dbengine page fetch timeout = 3
    dbengine page fetch retries = 3

[web]
    # Comprimir respuestas web
    enable gzip compression = yes
    gzip compression level = 3

[plugins]
    # Deshabilitar plugins que consumen muchos recursos
    # Puedes habilitarlos si los necesitas
    apps = yes
    cgroups = yes
    diskspace = yes
    ebpf = no
    go.d = yes
    ioping = no
    python.d = no
    charts.d = no
    node.d = no
    statsd = no

# Alertas personalizadas para Orange Pi
[health]
    enabled = yes
    
# Alerta: RAM crítica
[ram]
    alarm = ram_usage
    on = system.ram
    lookup = average -1m percentage of used
    warn = $this > 75
    crit = $this > 90
    info = Uso de RAM alto

# Alerta: Swap crítico
[swap]
    alarm = swap_usage
    on = system.swap
    lookup = average -1m percentage of used
    warn = $this > 50
    crit = $this > 80
    info = Uso de SWAP alto - riesgo de crash

# Alerta: Temperatura alta
# Nota: Ajusta el path según tu sistema
# Puedes encontrarlo con: find /sys/devices -name temp
